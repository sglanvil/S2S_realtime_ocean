/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh ENTER
#trap '[[ $BASH_COMMAND != echo* ]] && $BASH_COMMAND' DEBUG
#-------------------------------------------------------------------------------
# LID=$(date +%y%m%d-%H%M%S)
# LOGFILE=$(pwd)/master.$YEAR.log.$LID


DATADIR=/glade/scratch/ssfcst/JRA55_data             # where input, output, & intermediate data is here
HOMEDIR=/glade/u/home/ssfcst//JRA55-do               # where the standard JRA55-do scripts are
SCRIPTDIR=/glade/u/home/ssfcst/JRA55-do/cesm-scripts # where the CESM wrapper scripts are

YEARs=2020    # start date: year 
MONTHs=1      # start date: month 
DAYs=1        # start date: day in month
ODAYs=1       # start date: ordinal day (day in year)

YEARe=2020    # end date: year -- ?  assume YEARs = YEARe
MONTHe=2      # end date: month 
DAYe=29       # end date: day in month
ODAYe=60      # end date: ordinal day
DATESTRe=2020-02-29 # end date: text string for netCDF file name

DATESTRc=20210106 # end date: text string for netCDF file name

YEARp=2020    # end date: year -- ?  assume YEARs = YEARp
MONTHp=3      # day after end date: month
DAYp=1        # day after end date: day
ODAYp=61      # day after end date: ordinal day

COMPILE=TRUE    # TRUE => compile code
DOWNLOAD=TRUE   # download ftp data

DO_STEP0=FALSE
DO_STEP1=FALSE
DO_STEP2=FALSE
DO_STEP3=FALSE
DO_STEP4=FALSE
DO_STEP5=FALSE
DO_STEP6=FALSE
DO_STEP7=FALSE
DO_STEP8=TRUE 
LOGFILE=${CASEDIR}/${0}.${LID}
echo "$0 LOGFILE = $LOGFILE"
/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh LOGFILE = /glade/u/home/ssfcst/JRA55-do/cesmTEST202002//glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh.210107-021309
echo "$0 HOMEDIR = $LOGFILE"
/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh HOMEDIR = /glade/u/home/ssfcst/JRA55-do/cesmTEST202002//glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh.210107-021309
#-------------------------------------------------------------------------------

echo "==========================================================================="
===========================================================================
echo "8 Create dataset product for input4MIPs "                
8 Create dataset product for input4MIPs 
echo "==========================================================================="
===========================================================================

#-----------------------------------------------------------------------------------------
echo " When updating data in the middle of a year -------------------------------"
 When updating data in the middle of a year -------------------------------
echo "tStamp: $(date +%y%m%d-%H%M%S)"
tStamp: 210107-021309
#-----------------------------------------------------------------------------------------

cd $HOMEDIR/for_mricom
pwd
/glade/u/home/ssfcst/JRA55-do/for_mricom

LOGFILE=$CASEDIR/make_mricom_latest.$LID
time ./make_mricom_latest.sh  $YEARs $ODAYe   >& $LOGFILE

real	2m48.032s
user	0m11.610s
sys	0m25.062s
#  input: .../linkdir/work/jra55fcst_filt_3hr_TL319       # slprs, brtmp, ice
#  input: .../linkdir/work/jra55fcst_v1_3_prod3_3hr_TL319 # tmp10m sph10m
#  input: .../linkdir/work/jra55fcst_v1_3_prod1_3hr_TL319 # u10m v10m
#  input: .../linkdir/work/jra55fcst_v1_3_rad2_3hr_TL319  # dswrf dlwrf v1_3 => const correction
#  input: .../linkdir/work/jra55fcst_v1_3_prcp2_3hr_TL319 # rain snow
# output: .../linkdir/products/version_1_5/grads (excluding rain data which was created in step 7)

#-----------------------------------------------------------------------------------------
echo " Intermediate netCDF data -------------------------------------------------"
 Intermediate netCDF data -------------------------------------------------
echo "tStamp: $(date +%y%m%d-%H%M%S)"
tStamp: 210107-021557
#-----------------------------------------------------------------------------------------

cd $HOMEDIR/for_omip
pwd
/glade/u/home/ssfcst/JRA55-do/for_omip

LOGFILE=$CASEDIR/create_netcdf_v1_5.$LID
time ./create_netcdf_v1_5.sh  $YEARs $YEARe $DATESTRc $ODAYe >& $LOGFILE

real	0m0.230s
user	0m0.207s
sys	0m0.576s
#  input: .../linkdir/products/version_1_5/grads
# output: .../linkdir/products/version_1_5/netCDF

#-----------------------------------------------------------------------------------------
echo " CMORized files for input4MIPs---------------------------------------------"
 CMORized files for input4MIPs---------------------------------------------
echo "tStamp: $(date +%y%m%d-%H%M%S)"
tStamp: 210107-021557
#-----------------------------------------------------------------------------------------

cd $HOMEDIR/for_omip_cmor/MRI-JMA-JRA55-do-1-5-0 
pwd
/glade/u/home/ssfcst/JRA55-do/for_omip_cmor/MRI-JMA-JRA55-do-1-5-0

echo "TBD -- python code that must be edited? "
TBD -- python code that must be edited? 

#  input: .../linkdir/products/version_1_5/netCDF
# output: .../linkdir/products/version_1_5/input4MIPs

echo ${0} "EXIT"
/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh EXIT
