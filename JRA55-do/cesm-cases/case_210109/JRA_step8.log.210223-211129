/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh ENTER
#trap '[[ $BASH_COMMAND != echo* ]] && $BASH_COMMAND' DEBUG
#-------------------------------------------------------------------------------
# LID=$(date +%y%m%d-%H%M%S)
# LOGFILE=$(pwd)/master.$YEAR.log.$LID

alias wgrib=/glade/u/home/ssfcst/local/bin/wgrib

DATADIR=/glade/campaign/cesm/development/cross-wg/S2S/JRA55_data # where input, output, intermediate data is
HOMEDIR=/glade/u/home/ssfcst//JRA55-do               # where the standard JRA55-do scripts are
SCRIPTDIR=/glade/u/home/ssfcst/JRA55-do/cesm-scripts # where the CESM wrapper scripts are

YEARs=2021    # start date: year 
MONTHs=1      # start date: month 
DAYs=1        # start date: day in month
ODAYs=1       # start date: ordinal day (day in year)

YEARe=2021    # end date: year -- ?  assume YEARs = YEARe
MONTHe=1      # end date: month 
DAYe=9        # end date: day in month
ODAYe=9       # end date: ordinal day
DATESTRe=2021-01-09 # end date: text string for netCDF file name

DATESTRc=20210211 # end date: text string for netCDF file name

YEARp=2021    # end date: year -- ?  assume YEARs = YEARp
MONTHp=1      # day after end date: month
DAYp=10       # day after end date: day
ODAYp=10      # day after end date: ordinal day

COMPILE=FALSE   # TRUE => compile code
DOWNLOAD=TRUE   # download ftp data

DO_STEP0=FALSE
DO_STEP1=FALSE
DO_STEP2=FALSE
DO_STEP3=FALSE
DO_STEP4=FALSE
DO_STEP5=FALSE
DO_STEP6=FALSE
DO_STEP7=FALSE
DO_STEP8=TRUE 
LOGFILE=${CASEDIR}/${0}.${LID}
echo "$0 LOGFILE = $LOGFILE"
/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh LOGFILE = /glade/u/home/ssfcst/JRA55-do/cesm-cases/case_210109//glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh.210223-211129
echo "$0 HOMEDIR = $LOGFILE"
/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh HOMEDIR = /glade/u/home/ssfcst/JRA55-do/cesm-cases/case_210109//glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh.210223-211129
#-------------------------------------------------------------------------------

echo "==========================================================================="
===========================================================================
echo "8 Create dataset product for input4MIPs "                
8 Create dataset product for input4MIPs 
echo "==========================================================================="
===========================================================================


#-----------------------------------------------------------------------------------------
echo " CMORized files for input4MIPs---------------------------------------------"
 CMORized files for input4MIPs---------------------------------------------
echo "tStamp: $(date +%y%m%d-%H%M%S)"
tStamp: 210223-211129
#-----------------------------------------------------------------------------------------

cd $HOMEDIR/for_omip_cmor/MRI-JMA-JRA55-do-1-5-0 
pwd
/glade/u/home/ssfcst/JRA55-do/for_omip_cmor/MRI-JMA-JRA55-do-1-5-0

echo "TBD -- python code that must be edited? "
TBD -- python code that must be edited? 
sed -e s/@year@/${YEARe}/ \
    -e s/@create@/${DATESTRc}/ \
    runCmorAllWrite-1-5-0-update-atmos.py_template > runCmorAllWrite-1-5-0-update-atmos.py

# conda init
# conda activate mypy38  #BK set up this python env prior to running this script
python  runCmorAllWrite-1-5-0-update-atmos.py

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 

! ------
! All files were closed successfully. 
! ------
! 
key,var: A3hr rain
filePath: input_atmos/rain.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hr.json
inputVarName: prrn
outputVarName: prra
outputUnits: kg m-2 s-1
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hr snow
filePath: input_atmos/snow.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hr.json
inputVarName: prsn
outputVarName: prsn
outputUnits: kg m-2 s-1
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hr rlds
filePath: input_atmos/rlds.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hr.json
inputVarName: rlds
outputVarName: rlds
outputUnits: W m-2
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hr rsds
filePath: input_atmos/rsds.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hr.json
inputVarName: rsds
outputVarName: rsds
outputUnits: W m-2
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hrPt q_10
filePath: input_atmos/q_10.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hrPt.json
inputVarName: huss_10m
outputVarName: huss
outputUnits: 1.0
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hrPt slp
filePath: input_atmos/slp.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hrPt.json
inputVarName: psl
outputVarName: psl
outputUnits: Pa
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hrPt t_10
filePath: input_atmos/t_10.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hrPt.json
inputVarName: tas_10m
outputVarName: tas
outputUnits: K
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hrPt u_10
filePath: input_atmos/u_10.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hrPt.json
inputVarName: uas_10m
outputVarName: uas
outputUnits: m s-1
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..
key,var: A3hrPt v_10
filePath: input_atmos/v_10.2021.20210211.nc
cmorTable: Tables/input4MIPs_A3hrPt.json
inputVarName: vas_10m
outputVarName: vas
outputUnits: m s-1
Source data read start..
Source data read end..
Start CMORizing..
Start CMOR write..
End CMOR write..

#  input: .../linkdir/products/version_1_5/netCDF/*YEAR.CREATE.nc
# output: .../linkdir/products/version_1_5/input4MIPs

echo ${0} "EXIT"
/glade/u/home/ssfcst/JRA55-do/cesm-scripts/JRA_step8.sh EXIT
